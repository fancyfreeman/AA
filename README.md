# AA（Automated data Analysis tool）——自动化数据分析工具

## 项目简介
AA是一款自动化数据分析工具，适合用于在组织内部，对各经营机构的业务指标进行自动化监测分析，工具支持：
- 支持灵活接入业务指标数据，可适配手工报表或者标准数据表；
- 支持灵活配置业务指标监测模板，通过多种指标监测算子，对指标变动进行监测，输出监测结果；
- 支持分析报告生成；
- 应用扩展：用户可以将生成报告提交给AI大模型（如Deepseek），让其对分析报告进行总结提炼，总结业务发展的亮点与不足，形成指标监测的解读结果。

AA具有灵活可配置、高度自动化的特点，结合AI可以实现指标监测报告的智能解读，将大大提高业务分析的效率，减轻数据分析工作的强度：
- **数据处理自动化**，提高数据抽取、清洗、整合的效率；
- **指标解读自动化**，提高对指标变动、解读的效率，释放人力；
- **分析结果智能化**，与AI结合后，提高业务分析的质量和效率；

## 工具使用流程
1. 数据预处理
   1. 数据预处理配置
   2. 数据预处理
2. 生成指标监测报告
   1. 指标监测报告模板配置
   2. 指标监测报告生成
3. 指标监测报告解读（可选）
   1. 将指标监测报告提交给AI，通过提示词，让AI解读分析报告，提炼分析结论

## 快速开始
### 安装 (提供windows macOS 两个平台的安装指引 )
```Shell
# 1.从github下载AA
git clone https://github.com/fancyfreeman/AA.git

# 2.安装python，检查python，要求使用 python 3.10+ 以上版本
python -V
Python 3.13.2

# 3.创建python虚拟环境
cd AA                     # 进入工具目录
python -m venv .venv      # 创建虚拟环境 .venv
source .venv/bin/activate # 激活虚拟环境 如需取消激活虚拟环境 执行 deactivate

# 4.安装依赖包
cd AA
pip install -r requirements.txt

# 


```
### 运行（以使用样例数据为例进行说明）
```Shell
cd AA                     # 进入工具目录
python ./src/main.py -T 1
```

## 使用说明
### 目录结构
```
.                                                              
├── config                                                     # 配置文件夹
│   └── X公司样例_零售业                                         # 样例配置项目目录
│       ├── data_extraction_config_X公司样例_零售业.xlsx         # 数据预处理配置文件
│       └── report_config_X公司样例_零售业_分店.yaml              # 指标监测报告模板
├── data                                                       # 数据目录
│   ├── processed                                              # 数据预处理目录
│   │   └── data_preprocessed.xlsx                             # 数据预处理结果
│   └── raw                                                    # 原始数据
│       └── X公司样例_零售业                                     # 样例原始数据目录
│           └── X公司样例_零售业_标准表数据.xlsx                   # 样例原始数据
├── docs                                                       # 文档目录
├── README.md                                                  # 项目简介
├── reports                                                    # 指标监测报告目录
│   ├── X公司门店销售经营分析报告_广州分店_2024-12-31.md            # 指标监测报告
│   ├── X公司门店销售经营分析报告_杭州分店_2024-12-31.md            # 指标监测报告
│   ├── X公司门店销售经营分析报告_南京分店_2024-12-31.md            # 指标监测报告
│   ├── X公司门店销售经营分析报告_厦门分店_2024-12-31.md            # 指标监测报告
│   ├── X公司门店销售经营分析报告_上海分店_2024-12-31.md            # 指标监测报告
│   └── X公司门店销售经营分析报告_深圳分店_2024-12-31.md            # 指标监测报告
├── requirements.txt                                           # 项目依赖
└── src                                                        # 源文件
    ├── aa                                                     # 程序包
    └── main.py                                                # 程序主入口
```
数据命名规范（建议）
config/ 该目录存放数据抽取配置文件和分析报告模板模板文件
data/raw 该目录存放原始excel数据
如 data_extraction_config_X公司样例_零售业.xlsx
### 数据预处理
#### 数据预处理配置
（介绍配置文件内容）
这里以data_extraction_config_X公司样例_零售业.xlsx为例，介绍数据预处理的配置方法。
配置文件中，一共可以配置7类信息，对于7个sheet：
![X](docs/image/1.png)
1. multi_sheet_df 用于配置标准表
2. single_sheet_df 用于配置手工表
3. 机构分组 用于配置机构分组
4. 过滤机构 用于配置需要过滤的机构名称，按需配置，非必须
5. 机构名替换 用于规范机构名称，按需配置，非必须
6. ASC_ORDERED_KEYWORDS 配置需要按升序排名的指标，如退货率，按需配置，非必须
7. PERCENTAGE_KEYWORDS 配置需要按百分比展示的指标，展示效果为 XX%，按需配置，非必须
数据预处理模块目前支持两类数据表接入：标准表和手工报表。
- 标准表：指表格结构非常标准的数据表格，可以理解为从数据库中直接查询得到的表，只有一行表头，无单元格合并等特殊操作。
- 手工表：指在实际业务场景中，存在大量手工制作的报表，这类报表表头往往比较复杂，程序无法直接识别，需要增加细节的配置信息



### 生成指标监测报告

### 指标监测报告解读（需要AI支持，如DeepSeek-R1）


## 许可证
MIT License
